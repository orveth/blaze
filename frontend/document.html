<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <meta name="theme-color" content="#0f0f0e">
    <meta name="color-scheme" content="dark">
    
    <title>Document â€” Blaze</title>
    
    <link rel="stylesheet" href="/static/style.css">
    <link rel="stylesheet" href="/static/document.css">
</head>
<body>
    <!-- Top bar - minimal on mobile -->
    <header class="doc-header">
        <nav class="doc-nav" aria-label="Document navigation">
            <a href="#" class="back-link" id="backLink" aria-label="Back to plans">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
                    <path d="M19 12H5M12 19l-7-7 7-7" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
                <span class="back-text">Back</span>
            </a>
        </nav>

        <div class="doc-title-area">
            <span class="doc-plan-title" id="planTitle">Plan</span>
            <span class="doc-separator" aria-hidden="true">/</span>
            <h1 class="doc-file-name" id="fileName">document.md</h1>
        </div>

        <div class="doc-actions">
            <button class="doc-btn" id="editBtn" type="button" aria-label="Edit document">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
                    <path d="M11 4H4a2 2 0 00-2 2v14a2 2 0 002 2h14a2 2 0 002-2v-7" stroke-linecap="round" stroke-linejoin="round"/>
                    <path d="M18.5 2.5a2.121 2.121 0 013 3L12 15l-4 1 1-4 9.5-9.5z" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
                <span>Edit</span>
            </button>
        </div>
    </header>

    <!-- Main content area -->
    <main class="doc-main">
        <!-- View mode: rendered markdown -->
        <article class="doc-view" id="docView">
            <div class="doc-content prose" id="docContent">
                <div class="loading">Loading...</div>
            </div>
        </article>
        
        <!-- Edit mode: editor -->
        <section class="doc-edit" id="docEdit" style="display: none;" aria-label="Document editor">
            <div class="editor-toolbar">
                <label for="filenameInput" class="visually-hidden">Filename</label>
                <input type="text" class="filename-input" id="filenameInput" placeholder="filename.md" aria-label="Filename">
                <div class="toolbar-spacer"></div>
                <button class="toolbar-btn" id="previewBtn" type="button" aria-label="Preview document">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
                        <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z" stroke-linecap="round" stroke-linejoin="round"/>
                        <circle cx="12" cy="12" r="3"/>
                    </svg>
                    <span>Preview</span>
                </button>
            </div>
            <label for="docEditor" class="visually-hidden">Document content</label>
            <textarea class="doc-editor" id="docEditor" placeholder="Write your document in Markdown..." aria-label="Document content"></textarea>
            <footer class="editor-footer">
                <button class="btn-ghost" id="cancelEditBtn" type="button">Cancel</button>
                <button class="btn-primary" id="saveBtn" type="button">Save</button>
            </footer>
        </section>
        
        <!-- Preview mode (during edit) -->
        <section class="doc-preview" id="docPreview" style="display: none;" aria-label="Document preview">
            <div class="preview-toolbar">
                <span class="preview-label">Preview</span>
                <div class="toolbar-spacer"></div>
                <button class="toolbar-btn" id="backToEditBtn" type="button" aria-label="Back to editor">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
                        <path d="M11 4H4a2 2 0 00-2 2v14a2 2 0 002 2h14a2 2 0 002-2v-7" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M18.5 2.5a2.121 2.121 0 013 3L12 15l-4 1 1-4 9.5-9.5z" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    <span>Edit</span>
                </button>
            </div>
            <div class="doc-content prose" id="previewContent"></div>
            <footer class="editor-footer">
                <button class="btn-ghost" id="cancelPreviewBtn" type="button">Cancel</button>
                <button class="btn-primary" id="savePreviewBtn" type="button">Save</button>
            </footer>
        </section>
    </main>

    <!-- Login Modal -->
    <dialog id="loginModal">
        <div class="modal-content">
            <h3>Sign in</h3>
            <form id="loginForm">
                <input type="password" id="password" name="password" required autofocus placeholder="Token">
                <button type="submit">Continue</button>
            </form>
        </div>
    </dialog>

    <!-- Delete Confirm Modal -->
    <dialog id="confirmModal">
        <div class="modal-content modal-sm">
            <p>Delete this document? This can't be undone.</p>
            <footer class="modal-footer">
                <button class="btn-ghost" id="confirmCancel">Cancel</button>
                <button class="btn-danger" id="confirmDelete">Delete</button>
            </footer>
        </div>
    </dialog>

    <div class="toast-container" id="toastContainer"></div>

    <!-- Markdown parser -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script src="/static/document.js"></script>
</body>
</html>
